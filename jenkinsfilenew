pipeline {
	agent any
        tools {
         maven 'maven3'
         }
         options {
           buildDiscarder logRotator(daysToKeepStr: '10', numToKeepStr: '7')
          }
          parameters {
            choice choices: ['develop', 'qa', 'master'], description: 'Choose the branch to build', name: 'branchName'
          }
          stages {
	    stage ('check out from SCM') {
               steps {
                  git credentialsId: 'Github', url: 'https://github.com/Radhakrishnamohan33/my-app'
		}
		                         }
             stage ('Maven Build'){
                 steps {
                   sh "mvn clean package"
                 }  
		 }
              stage ('Deploy to Tomcat'){
                 steps {
                   sshagent(['Tomcat']) {
                     sh "scp -o StrictHostKeyChecking=no target/*.war ec2-user@13.233.97.179:/opt/tomcat9/webapps/"
                     }
	         
             }    
            }
	    }
}



